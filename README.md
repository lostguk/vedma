# Магазин магических товаров

## О проекте

Магазин магических товаров - это современный веб-сервис для продажи магических товаров и аксессуаров.
Проект построен на Laravel 11 с использованием современных технологий и практик.

## Технический стек

-   PHP 8.3
-   Laravel 11
-   Docker
-   MySQL 8.0
-   Filament (админ-панель)
-   Scribe (документация API)

## Установка и запуск

### Требования

-   Docker и Docker Compose
-   Git

### Шаги по установке

1. Клонируйте репозиторий:

    ```md
    git clone git@github.com:username/shop.git
    cd shop
    ```

2. Скопируйте файл окружения:

    ```bash
    cp .env.example .env
    ```

3. Запустите Docker-контейнеры:

    ```bash
    docker-compose -f docker-compose.yml -f docker-compose.dev.yml up --build
    ```

4. Веб-приложение будет доступно по адресу:

    ```text
    http://localhost:8000
    ```

### API Документация

Документация API автоматически генерируется с помощью Scribe и доступна по адресу:

```text
http://localhost:8000/docs
```

API документация организована в следующие группы для удобной навигации:

-   **Аутентификация**: регистрация и авторизация пользователей
-   **Категории**: просмотр категорий товаров
-   **Продукты**: работа с товарами, фильтрация и сортировка

Документация включает примеры запросов, подробные описания параметров и ответов, а также позволяет тестировать API прямо из браузера через функцию "Try It Out".

Для обновления документации после внесения изменений в API выполните:

```bash
docker exec shop_php php artisan scribe:generate
```

### Группировка эндпоинтов в API

При добавлении новых эндпоинтов в API, вы можете включать их в существующие группы или создавать новые с помощью аннотации `@group`.

Например:

```php
/**
 * @group Заказы
 * API для работы с заказами
 */
class OrderController extends ApiController
{
    // методы контроллера
}
```

Порядок групп можно настроить в файле `config/scribe.php` в секции `groups.order`.

### Админ-панель

Админ-панель построена на основе Filament и доступна по адресу:

```text
http://localhost:8000/admin
```

## Разработка

### Генерация документации API

При запуске контейнеров документация API генерируется автоматически. Если вы внесли изменения в API и хотите обновить документацию, выполните:

```bash
docker exec shop_php_dev php artisan scribe:generate
```

### Запуск тестов

```bash
docker exec shop_php_dev php artisan test
```

## Настройка UID/GID для Docker (важно для macOS/Linux)

Для корректной работы прав и git внутри контейнера, добавьте в .env:

```
HOST_UID=1000  # id -u на вашей машине
HOST_GID=1000  # id -g на вашей машине
```

-   На macOS обычно UID=501, GID=20 (проверьте через терминал: `id -u`, `id -g`).
-   На Linux обычно UID=1000, GID=1000.

Это обеспечит правильные права на volume и отсутствие ошибок git/composer.

После изменения переменных пересоберите контейнер:

```
docker-compose -f docker-compose.dev.yml build --no-cache php
docker-compose -f docker-compose.dev.yml up -d
```
