# Магазин магических товаров

## О проекте

Магазин магических товаров - это современный веб-сервис для продажи магических товаров и аксессуаров.
Проект построен на Laravel 11 с использованием современных технологий и практик.

## Технический стек

-   PHP 8.3
-   Laravel 11
-   Docker
-   MySQL 8.0
-   Filament (админ-панель)
-   Scribe (документация API)

## Установка и запуск

### Требования

-   Docker Desktop 4.0+ или Docker Engine 20.10+
-   Docker Compose 2.0+
-   Git

### Быстрый старт (рекомендуется)

Проект использует Laravel Sail для локальной разработки:

1. Клонируйте репозиторий:

    ```bash
    git clone <repository-url>
    cd vedma
    ```

2. Скопируйте файл окружения:

    ```bash
    cp .env.example .env
    ```

3. Запустите приложение:

    ```bash
    ./dev.sh up        # Запустить контейнеры
    ./dev.sh install   # Установить зависимости
    ./sail artisan key:generate  # Сгенерировать ключ
    ./dev.sh reset-db  # Выполнить миграции и сиды
    ./sail artisan storage:link  # Создать символическую ссылку
    ```

4. Приложение будет доступно:
    - **Веб-приложение**: http://localhost
    - **Админ-панель**: http://localhost/admin
    - **API документация**: http://localhost/docs
    - **Mailpit (почта)**: http://localhost:8025

### Основные команды разработки

```bash
./dev.sh up        # Запустить контейнеры
./dev.sh down      # Остановить контейнеры
./dev.sh bash      # Войти в контейнер
./dev.sh test      # Запустить тесты
./dev.sh lint      # Форматировать код
./dev.sh docs      # Обновить API документацию
./dev.sh help      # Все доступные команды
```

Подробная документация: [Docker Setup Guide](docs/docker/DOCKER_SETUP.md)

### API Документация

Документация API автоматически генерируется с помощью Scribe и доступна по адресу:

```text
http://localhost/docs
```

API документация организована в следующие группы для удобной навигации:

-   **Аутентификация**: регистрация и авторизация пользователей
-   **Категории**: просмотр категорий товаров
-   **Продукты**: работа с товарами, фильтрация и сортировка

Документация включает примеры запросов, подробные описания параметров и ответов, а также позволяет тестировать API прямо из браузера через функцию "Try It Out".

Для обновления документации после внесения изменений в API выполните:

```bash
./dev.sh docs
```

### Группировка эндпоинтов в API

При добавлении новых эндпоинтов в API, вы можете включать их в существующие группы или создавать новые с помощью аннотации `@group`.

Например:

```php
/**
 * @group Заказы
 * API для работы с заказами
 */
class OrderController extends ApiController
{
    // методы контроллера
}
```

Порядок групп можно настроить в файле `config/scribe.php` в секции `groups.order`.

### Админ-панель

Админ-панель построена на основе Filament и доступна по адресу:

```text
http://localhost/admin
```

## Разработка

### Генерация документации API

При запуске контейнеров документация API генерируется автоматически. Если вы внесли изменения в API и хотите обновить документацию, выполните:

```bash
./dev.sh docs
```

### Запуск тестов

```bash
./dev.sh test
```

### Продакшн развертывание

Для продакшн окружения используется отдельная Docker конфигурация:

```bash
ENV=production ./dev.sh build   # Собрать образ
ENV=production ./dev.sh deploy  # Развернуть приложение
ENV=production ./dev.sh backup  # Создать бэкап БД
```

Подробнее в [Docker Setup Guide](docs/docker/DOCKER_SETUP.md#продакшн-развертывание)

## Особенности платформ

Laravel Sail автоматически определяет вашу операционную систему и настраивает соответствующие права доступа. Дополнительная настройка обычно не требуется.

Если возникают проблемы с правами доступа:
- На macOS/Linux: права настраиваются автоматически через переменные окружения WWWUSER и WWWGROUP
- На Windows: используйте WSL2 для лучшей совместимости

## Структура проекта

- `app/` - основной код приложения
- `database/` - миграции, фабрики и сиды
- `docker/` - конфигурация Docker
- `docs/` - документация проекта
- `public/` - публичные файлы
- `resources/` - представления и ресурсы
- `routes/` - маршруты приложения
- `storage/` - кеш, логи и загруженные файлы
- `tests/` - тесты приложения
